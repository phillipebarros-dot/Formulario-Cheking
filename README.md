# Formul√°rio de Checking - OpusM√∫ltipla

![Status do Projeto](https://img.shields.io/badge/status-ativo-brightgreen)
![n8n](https://img.shields.io/badge/n8n-1.110.1%2B-blueviolet)
![Google Sheets](https://img.shields.io/badge/Google-Sheets-green)
![Google Drive](https://img.shields.io/badge/Google-Drive-yellow)

Este reposit√≥rio cont√©m o c√≥digo-fonte e a documenta√ß√£o completa do formul√°rio para submiss√£o de checkings da OpusM√∫ltipla. O projeto integra uma interface de usu√°rio inteligente com um robusto workflow de automa√ß√£o em n8n para otimizar e garantir a confiabilidade de todo o processo.

## üöÄ O Projeto

O objetivo principal deste projeto √© automatizar o processo de "Checking" de Propostas de Inser√ß√£o (PIs), resolvendo os gargalos do fluxo de trabalho manual. A solu√ß√£o substitui a troca de e-mails e a valida√ß√£o manual por um sistema centralizado que garante a integridade dos dados, organiza os arquivos de forma autom√°tica e notifica as equipes em tempo real, aumentando a efici√™ncia, a rastreabilidade e a confiabilidade da opera√ß√£o.

## ‚ú® Principais Funcionalidades

* **Auto-preenchimento Inteligente:** Ao digitar o n√∫mero da PI, o formul√°rio consulta a planilha de refer√™ncia em tempo real e preenche automaticamente os campos de `Cliente`, `Campanha`, `Produto`, `Per√≠odo`, `Ve√≠culo` e `Meio`, reduzindo a digita√ß√£o e prevenindo erros.
* **Valida√ß√£o H√≠brida (Front-end e Back-end):** O sistema valida m√∫ltiplas regras de neg√≥cio em diferentes etapas para garantir a m√°xima integridade dos dados:
    * **Feedback Imediato ao Usu√°rio:** O formul√°rio valida o preenchimento de campos obrigat√≥rios e a anexa√ß√£o de arquivos **antes** do envio, fornecendo feedback instant√¢neo e evitando requisi√ß√µes desnecess√°rias.
    * **Valida√ß√£o no Back-end:** O n8n revalida se a PI existe, se seu status √© "ativa" e se a quantidade m√≠nima de arquivos foi enviada.
* **Organiza√ß√£o Autom√°tica e Centralizada:** Os comprovantes s√£o salvos automaticamente em uma pasta espec√≠fica no Google Drive, nomeada dinamicamente com o n√∫mero da PI (ex: `PI_182429`), eliminando a organiza√ß√£o manual.
* **Notifica√ß√µes Imediatas:** Uma notifica√ß√£o por e-mail √© disparada para as equipes respons√°veis assim que um checking √© validado, garantindo que todos estejam cientes.
* **Registro de Log e Auditoria:** Cada envio bem-sucedido √© registrado com data e hora em uma aba espec√≠fica da planilha, criando um hist√≥rico completo e facilmente audit√°vel.

## üõ†Ô∏è Tecnologias Utilizadas

* üé® **Front-end:** HTML5, CSS3, JavaScript (Vanilla)
* ‚öôÔ∏è **Orquestra√ß√£o e Automa√ß√£o:** n8n (Self-Hosted)
* üíæ **Fonte de Dados e Armazenamento:** Google Sheets e Google Drive
* ‚òÅÔ∏è **Hospedagem do Formul√°rio:** GitHub Pages

## üåê Como Usar

1.  Acesse o formul√°rio hospedado online:
    **[https://phillipebarros-dot.github.io/Formulario-Cheking/](https://phillipebarros-dot.github.io/Formulario-Cheking/)**
2.  Digite o n√∫mero da PI e aguarde o preenchimento autom√°tico.
3.  Preencha seus dados de contato e anexe os arquivos de comprova√ß√£o.
4.  Clique em "Enviar". O sistema cuidar√° do resto e exibir√° uma mensagem de status.

## ü§ñ Como Funciona a Automa√ß√£o (n8n)

O formul√°rio se comunica com um workflow no n8n que executa uma sequ√™ncia l√≥gica detalhada para cada requisi√ß√£o. A automa√ß√£o √© dividida em duas rotas principais: uma para a busca r√°pida de dados da PI e outra para o processamento completo da submiss√£o.

Para uma an√°lise t√©cnica detalhada de cada n√≥ do workflow, **[consulte a documenta√ß√£o completa aqui](./WORKFLOW.md)**.

## üë®‚Äçüíª Para Desenvolvedores

### Comunica√ß√£o Front-end <> n8n
O `index.html` se comunica com o n8n atrav√©s de duas a√ß√µes distintas para o mesmo endpoint do Webhook:
1.  **Busca de PI:** Uma requisi√ß√£o `POST` com `Content-Type: application/json` e o corpo: `{ "action": "buscar_pi", "n_pi": "..." }`.
2.  **Submiss√£o de Formul√°rio:** Uma requisi√ß√£o `POST` com `Content-Type: multipart/form-data`, contendo todos os campos e arquivos.

### Configura√ß√£o Essencial do n8n (CORS)
Como o formul√°rio est√° em um dom√≠nio diferente da automa√ß√£o, √© **obrigat√≥rio** configurar o CORS no servidor n8n. Adicione as seguintes vari√°veis de ambiente √† sua inst√¢ncia:

```bash
# Permite que o seu formul√°rio no GitHub Pages fa√ßa requisi√ß√µes.
N8N_CORS_ALLOWED_ORIGINS=[https://phillipebarros-dot.github.io](https://phillipebarros-dot.github.io)

# Permite os m√©todos HTTP necess√°rios para a busca (POST) e verifica√ß√£o (OPTIONS).
N8N_CORS_ALLOWED_METHODS=GET,HEAD,POST,PUT,PATCH,DELETE,OPTIONS

# Permite os cabe√ßalhos que o navegador envia durante a comunica√ß√£o.
N8N_CORS_ALLOWED_HEADERS=Origin,X-Requested-With,Content-Type,Accept,Authorization,X-N8N-API-KEY
