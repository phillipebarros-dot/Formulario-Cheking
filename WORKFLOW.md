# Documenta√ß√£o T√©cnica do Workflow n8n

## üìã √çndice

- [Vis√£o Geral](#vis√£o-geral)
- [Arquitetura do Workflow](#arquitetura-do-workflow)
- [Fluxo Detalhado](#fluxo-detalhado)
- [Documenta√ß√£o dos N√≥s](#documenta√ß√£o-dos-n√≥s)
- [C√≥digos JavaScript](#c√≥digos-javascript)
- [Tratamento de Erros](#tratamento-de-erros)
- [Otimiza√ß√µes e Performance](#otimiza√ß√µes-e-performance)
- [Manuten√ß√£o e Monitoramento](#manuten√ß√£o-e-monitoramento)

## Vis√£o Geral

O workflow n8n do formul√°rio de checking processa duas opera√ß√µes principais atrav√©s de um √∫nico webhook:

1. **Busca de PI:** Consulta dados da planilha para auto-preenchimento
2. **Submiss√£o de Checking:** Valida, organiza no Drive e notifica

### Especifica√ß√µes T√©cnicas

| Item | Valor |
|------|-------|
| **Webhook URL** | `https://n8n.grupoom.com.br/webhook/CheckingForm` |
| **M√©todo HTTP** | POST |
| **Timeout** | 3600s (60 minutos) |
| **Max Payload** | 800MB |
| **Total de N√≥s** | 19 n√≥s |
| **Execu√ß√µes Paralelas** | Suportado |

## Arquitetura do Workflow

### Diagrama Visual

```mermaid
graph TD
    A[Webhook POST] --> B{√â Busca de PI?}
    
    B -->|Sim| C[Buscar PI no Sheets]
    C --> D[Formatar Resposta PI]
    D --> E[Responder JSON PI]
    
    B -->|N√£o| F[Validar Submiss√£o]
    F --> G{Valida√ß√£o OK?}
    
    G -->|N√£o| H[Responder Erro]
    
    G -->|Sim| I{√â Link do Drive?}
    
    I -->|Sim| J[Preparar Log Link]
    J --> K[Unificar Fluxos]
    
    I -->|N√£o| L[Buscar Pasta Cliente]
    L --> M{Pasta Existe?}
    
    M -->|N√£o| N[Criar Pasta Cliente]
    N --> O[Definir ID Cliente]
    M -->|Sim| O
    
    O --> P[Criar Pasta PI]
    P --> Q[Separar Cada Arquivo]
    Q --> R[Upload Arquivo Drive]
    R --> S[Aguardar Todos Uploads]
    S --> T[Preparar Log Binary]
    T --> K
    
    K --> U[Registrar Log Sheets]
    K --> V[Enviar E-mail]
    V --> W[Responder Sucesso]
```

### Estrutura de Dados

#### Entrada - Busca de PI
```json
{
  "action": "buscar_pi",
  "n_pi": "182429"
}
```

#### Entrada - Submiss√£o
```json
{
  "action": "submissao_form",
  "nome": "string",
  "email": "string",
  "telefone": "string",
  "n_pi": "string",
  "cliente": "string",
  "campanha": "string",
  "produto": "string",
  "periodo": "string",
  "veiculo": "string",
  "meio": "string",
  "observacoes": "string",
  "upload_method": "binary",
  "relatorio_fotografico_do": "File[]",
  // ... outros arquivos
}
```

## Fluxo Detalhado

### 1Ô∏è‚É£ Rota de Busca de PI

#### N√≥ 1: Webhook POST
**Tipo:** `n8n-nodes-base.webhook`
**Configura√ß√£o:**
```yaml
httpMethod: POST
path: CheckingForm
responseMode: responseNode
webhookId: checking-form-post
```

**Descri√ß√£o:** Recebe todas as requisi√ß√µes POST. O corpo da requisi√ß√£o √© disponibilizado em `$json.body`.

---

#### N√≥ 2: √â Busca de PI?
**Tipo:** `n8n-nodes-base.if`
**Condi√ß√£o:**
```javascript
$json.body.action === "buscar_pi"
```

**Descri√ß√£o:** Roteia para busca se `action` for `"buscar_pi"`, caso contr√°rio vai para submiss√£o.

---

#### N√≥ 3: Buscar PI no Sheets
**Tipo:** `n8n-nodes-base.googleSheets`
**Opera√ß√£o:** Read
**Configura√ß√£o:**
```yaml
documentId: "1iwUay2RE8k1PumivMbEjuzIyw4CBaktJ2YPsR1iwe_Q"
sheetName: "gid=0"  # Aba principal
filtersUI:
  - lookupColumn: "N_PI"
    lookupValue: "={{ $json.body.n_pi }}"
```

**Descri√ß√£o:** Busca linha onde coluna `N_PI` corresponde ao n√∫mero fornecido.

**Sa√≠da Esperada:**
```json
[
  {
    "N_PI": "182429",
    "CLIENTE": "NOME CLIENTE",
    "CAMPANHA": "CAMPANHA",
    "PRODUTO": "PRODUTO",
    "PERIODO": "01/01/2025 - 31/01/2025",
    "VEICULO": "VEICULO",
    "MEIO": "DO",
    "STATUS": "ativa"
  }
]
```

---

#### N√≥ 4: Formatar Resposta PI
**Tipo:** `n8n-nodes-base.code`
**C√≥digo:**
```javascript
const items = $input.all();

if (items.length === 0 || !items[0].json.N_PI) {
  return [{ 
    json: { 
      success: false, 
      error: 'PI n√£o encontrada' 
    } 
  }];
}

const pi = items[0].json;

return [{
  json: {
    success: true,
    cliente: pi.CLIENTE || '',
    campanha: pi.CAMPANHA || '',
    produto: pi.PRODUTO || '',
    periodo: pi.PERIODO || '',
    veiculo: pi.VEICULO || '',
    meio: pi.MEIO || ''
  }
}];
```

**Descri√ß√£o:** Transforma dados do Sheets em resposta JSON padronizada.

---

#### N√≥ 5: Responder JSON PI
**Tipo:** `n8n-nodes-base.respondToWebhook`
**Configura√ß√£o:**
```yaml
respondWith: json
responseBody: "={{ $json }}"
```

**Descri√ß√£o:** Envia resposta de volta ao formul√°rio.

---

### 2Ô∏è‚É£ Rota de Submiss√£o

#### N√≥ 6: Validar Submiss√£o
**Tipo:** `n8n-nodes-base.code`
**C√≥digo Completo:**
```javascript
const item = $input.item;
const body = item.json.body || {};
const binary = item.binary || {};
const erros = [];

// 1. Validar campos obrigat√≥rios
const camposObrigatorios = ['nome', 'email', 'telefone', 'n_pi'];
const camposFaltando = camposObrigatorios.filter(
  campo => !body[campo] || body[campo].trim() === ''
);

if (camposFaltando.length > 0) {
  erros.push(`Campos obrigat√≥rios faltando: ${camposFaltando.join(', ')}`);
}

// 2. Verificar m√©todo de upload
const uploadMethod = body.upload_method;
const driveLink = body.drive_link;

if (uploadMethod === 'drive_link') {
  // Validar link do Drive
  if (!driveLink || !driveLink.includes('drive.google.com')) {
    erros.push('Link do Google Drive inv√°lido.');
  } else {
    const matchFolder = driveLink.match(/folders\/([a-zA-Z0-9_-]+)/);
    const matchFile = driveLink.match(/[-\w]{25,}/);
    
    if (matchFolder) {
      item.json.driveFolderId = matchFolder[1];
      item.json.uploadMethod = 'drive_link';
    } else if (matchFile) {
      item.json.driveFolderId = matchFile[0];
      item.json.uploadMethod = 'drive_link';
    } else {
      erros.push('N√£o foi poss√≠vel extrair o ID do link do Drive.');
    }
  }
} else {
  // Validar anexos bin√°rios
  item.json.uploadMethod = 'binary';
  const meio = body.meio;
  
  const anexosRequeridosPorMeio = {
    'DO': ['relatorio_fotografico_do', 'relatorio_exibicoes_do', 'video_diurno_do'],
    'ME': ['relatorio_enderecos_me', 'fotos_pontos_me'],
    'MO': ['relatorio_estacoes_mo', 'fotos_videos_mo'],
    'BD': ['comprovante_bd'],
    'OD': ['comprovante_od_fl'],
    'FL': ['comprovante_od_fl'],
    'MI': ['comprovante_mi'],
    'AT': ['comprovante_geral'],
    'CI': ['comprovante_geral'],
    'IN': ['comprovante_geral'],
    'JO': ['comprovante_geral'],
    'RD': ['comprovante_geral'],
    'RV': ['comprovante_geral'],
    'TV': ['comprovante_geral'],
    'TP': ['comprovante_geral']
  };

  const camposAnexoRequeridos = anexosRequeridosPorMeio[meio];

  if (!meio) {
    erros.push('Campo Meio n√£o preenchido.');
  } else if (!camposAnexoRequeridos) {
    erros.push(`Meio '${meio}' n√£o possui regras de anexo definidas.`);
  } else {
    const anexosFaltando = [];
    
    camposAnexoRequeridos.forEach(campo => {
      const temArquivo = Object.keys(binary).some(key => {
        return key === campo || key.startsWith(campo + '_');
      });
      
      if (!temArquivo) {
        anexosFaltando.push(campo);
      }
    });
    
    if (anexosFaltando.length > 0) {
      erros.push(`Anexos obrigat√≥rios faltando: ${anexosFaltando.join(', ')}`);
    }
  }
}

item.json.validationResult = erros.length > 0
  ? { success: false, message: erros.join('; ') }
  : { success: true, message: 'Valida√ß√£o conclu√≠da.' };

return [item];
```

**Descri√ß√£o:** Valida√ß√£o completa de campos e arquivos. Suporta dois m√©todos de upload:
- **binary:** Arquivos anexados diretamente (< 500MB)
- **drive_link:** Link para pasta do Drive j√° criada (‚â• 500MB)

---

#### N√≥ 7: Valida√ß√£o OK?
**Tipo:** `n8n-nodes-base.if`
**Condi√ß√£o:**
```javascript
Boolean($json.validationResult?.success) === true
```

**Descri√ß√£o:** Verifica se n√£o houve erros na valida√ß√£o. Caso contr√°rio, retorna erro 400.

---

#### N√≥ 8: Responder Erro
**Tipo:** `n8n-nodes-base.respondToWebhook`
**Configura√ß√£o:**
```yaml
respondWith: json
responseBody: "={{ { \"success\": false, \"message\": $json.validationResult.message || \"Erro na valida√ß√£o.\" } }}"
options:
  responseCode: 400
```

**Descri√ß√£o:** Retorna mensagem de erro detalhada ao front-end.

---

#### N√≥ 9: √â Link do Drive?
**Tipo:** `n8n-nodes-base.if`
**Condi√ß√£o:**
```javascript
$json.uploadMethod === "drive_link"
```

**Descri√ß√£o:** Separa fluxo para uploads via link (‚â•500MB) vs bin√°rios (<500MB).

---

### 3Ô∏è‚É£ Rota: Link do Drive (‚â•500MB)

#### N√≥ 10: Preparar Log Link
**Tipo:** `n8n-nodes-base.code`
**C√≥digo:**
```javascript
const submissionData = $items('Validar Submiss√£o')[0].json;
const body = submissionData.body;

return [{
  json: {
    n_pi: body.n_pi || 'N/A',
    cliente: body.cliente || 'N/A',
    veiculo: body.veiculo || 'N/A',
    nome: body.nome || 'N/A',
    email: body.email || 'N/A',
    telefone: body.telefone || 'N/A',
    meio: body.meio || 'N/A',
    observacoes: body.observacoes || '',
    totalArquivos: 'Via Link Drive',
    uploadMethod: 'drive_link',
    webViewLink: body.drive_link || 'Link n√£o fornecido'
  }
}];
```

**Descri√ß√£o:** Prepara dados para log quando usu√°rio fornece link do Drive.

---

### 4Ô∏è‚É£ Rota: Upload Bin√°rio (<500MB)

#### N√≥ 11: Buscar Pasta Cliente
**Tipo:** `n8n-nodes-base.googleDrive`
**Opera√ß√£o:** Search
**Configura√ß√£o:**
```yaml
searchMethod: query
queryString: "={{ \"name='\" + $items('Validar Submiss√£o')[0].json.body.cliente.trim().toUpperCase() + \"' and mimeType='application/vnd.google-apps.folder' and '1OEL4MtYKd5Tg-ZOmsIRG9RQkvfX-xs_s' in parents and trashed=false\" }}"
```

**Descri√ß√£o:** Busca pasta do cliente dentro da pasta raiz "Checkings". O ID `1OEL4MtYKd5Tg-ZOmsIRG9RQkvfX-xs_s` √© a pasta raiz.

**Query traduzida:**
```
name='NOME_CLIENTE' 
and mimeType='application/vnd.google-apps.folder' 
and '1OEL4MtYKd5Tg-ZOmsIRG9RQkvfX-xs_s' in parents 
and trashed=false
```

---

#### N√≥ 12: Pasta Cliente Existe?
**Tipo:** `n8n-nodes-base.if`
**Condi√ß√£o:**
```javascript
$json.id != null
```

**Descri√ß√£o:** Verifica se a busca retornou uma pasta. Se n√£o, cria nova pasta.

---

#### N√≥ 13: Criar Pasta Cliente
**Tipo:** `n8n-nodes-base.googleDrive`
**Opera√ß√£o:** Create Folder
**Configura√ß√£o:**
```yaml
name: "={{ $items('Validar Submiss√£o')[0].json.body.cliente.toUpperCase() }}"
folderId: "1OEL4MtYKd5Tg-ZOmsIRG9RQkvfX-xs_s"  # Pasta raiz Checkings
```

**Descri√ß√£o:** Cria pasta com nome do cliente em UPPERCASE dentro da pasta raiz.

---

#### N√≥ 14: Definir ID da Pasta Cliente
**Tipo:** `n8n-nodes-base.set`
**Configura√ß√£o:**
```yaml
assignments:
  - name: clientFolderId
    value: "={{ $json.id }}"
    type: string
```

**Descri√ß√£o:** Captura o ID da pasta (encontrada ou criada) para usar na pr√≥xima etapa.

---

#### N√≥ 15: Criar Pasta PI
**Tipo:** `n8n-nodes-base.googleDrive`
**Opera√ß√£o:** Create Folder
**Configura√ß√£o:**
```yaml
name: "={{ 'PI ' + $items('Validar Submiss√£o')[0].json.body.n_pi + ' - ' + $items('Validar Submiss√£o')[0].json.body.cliente.replace(/[\/\\?%*:|\"<>]/g, '-') + ' - ' + $now.toFormat(\"dd-MM-yyyy HH'h'mm\") }}"
folderId: "={{ $json.clientFolderId }}"
```

**Exemplo de nome gerado:**
```
PI 182429 - CLIENTE XYZ - 15-10-2025 14h30
```

**Descri√ß√£o:** Cria pasta espec√≠fica da PI dentro da pasta do cliente, com timestamp.

---

#### N√≥ 16: Separar Cada Arquivo
**Tipo:** `n8n-nodes-base.code`
**C√≥digo:**
```javascript
const submissionItem = $items('Validar Submiss√£o')[0];
const piFolderId = $json.id;

const binary = submissionItem.binary || {};
const arquivos = [];

let totalArquivos = 0;

for (const key in binary) {
  totalArquivos++;
  arquivos.push({
    json: {
      ...submissionItem.json,
      piFolderId: piFolderId,
      nomeArquivoOriginal: binary[key].fileName || `arquivo_${totalArquivos}`,
      mimeType: binary[key].mimeType || 'application/octet-stream',
      totalArquivos: 0
    },
    binary: {
      data: binary[key]
    }
  });
}

// Atualizar total em todos os itens
arquivos.forEach(item => {
  item.json.totalArquivos = totalArquivos;
});

return arquivos.length > 0 ? arquivos : [{ json: { erro: 'Nenhum arquivo encontrado' } }];
```

**Descri√ß√£o:** Converte objeto com m√∫ltiplos arquivos bin√°rios em array de itens individuais para upload paralelo.

**Entrada:**
```javascript
{
  binary: {
    relatorio_fotografico_do: File1,
    relatorio_exibicoes_do: File2,
    video_diurno_do: File3
  }
}
```

**Sa√≠da:**
```javascript
[
  { json: {...}, binary: { data: File1 } },
  { json: {...}, binary: { data: File2 } },
  { json: {...}, binary: { data: File3 } }
]
```

---

#### N√≥ 17: Upload Arquivo no Drive
**Tipo:** `n8n-nodes-base.googleDrive`
**Opera√ß√£o:** Upload
**Configura√ß√£o:**
```yaml
folderId: "={{ $json.piFolderId }}"
```

**Descri√ß√£o:** Faz upload de cada arquivo individualmente na pasta da PI. Executa em paralelo para todos os arquivos.

---

#### N√≥ 18: Aguardar Todos Uploads
**Tipo:** `n8n-nodes-base.merge`
**Modo:** Combine All
**Configura√ß√£o:**
```yaml
mode: combine
combineBy: combineAll
```

**Descri√ß√£o:** Aguarda conclus√£o de todos os uploads paralelos antes de prosseguir.

---

#### N√≥ 19: Preparar Log Binary
**Tipo:** `n8n-nodes-base.code`
**C√≥digo:**
```javascript
const todosUploads = $input.all();
const submissionData = $items('Validar Submiss√£o')[0].json.body;
const pastaPi = $items('Criar Pasta PI')[0].json;

return [{
  json: {
    n_pi: submissionData.n_pi || 'N/A',
    cliente: submissionData.cliente || 'N/A',
    veiculo: submissionData.veiculo || 'N/A',
    nome: submissionData.nome || 'N/A',
    email: submissionData.email || 'N/A',
    telefone: submissionData.telefone || 'N/A',
    meio: submissionData.meio || 'N/A',
    observacoes: submissionData.observacoes || '',
    totalArquivos: todosUploads.length,
    uploadMethod: 'binary',
    webViewLink: pastaPi.webViewLink || 'https://drive.google.com/drive/folders/' + pastaPi.id
  }
}];
```

**Descri√ß√£o:** Consolida informa√ß√µes de todos os uploads em um √∫nico objeto para log.

---

### 5Ô∏è‚É£ Unifica√ß√£o e Finaliza√ß√£o

#### N√≥ 20: Unificar Fluxos
**Tipo:** `n8n-nodes-base.merge`
**Descri√ß√£o:** Une os dados vindos do fluxo de link e do fluxo bin√°rio em um √∫nico fluxo.

---

#### N√≥ 21: Registrar Log no Sheets
**Tipo:** `n8n-nodes-base.googleSheets`
**Opera√ß√£o:** Append
**Configura√ß√£o:**
```yaml
documentId: "1iwUay2RE8k1PumivMbEjuzIyw4CBaktJ2YPsR1iwe_Q"
sheetName: 1807228652  # Log_Checkings
columns:
  PI: "={{ $json.n_pi }}"
  Ve√≠culo: "={{ $json.veiculo }}"
  Cliente: "={{ $json.cliente }}"
  Data: "={{ $now.toFormat('dd/MM/yyyy HH:mm:ss') }}"
  Qtd_Arquivos: "={{ $json.totalArquivos }}"
  Status: "Enviado"
```

**Descri√ß√£o:** Adiciona nova linha na aba "Log_Checkings" com todos os detalhes da submiss√£o.

---

#### N√≥ 22: Enviar E-mail Notifica√ß√£o
**Tipo:** `n8n-nodes-base.emailSend`
**Configura√ß√£o:**
```yaml
fromEmail: "marleneg@opusmultipla.com.br"
toEmail: "marleneg@opusmultipla.com.br"
subject: "=Novo Checking Recebido - PI {{ $json.n_pi }}"
html: "=<!DOCTYPE html>...</html>"  # Template HTML completo
```

**Template de E-mail:** Ver se√ß√£o [Template HTML](#template-html-do-e-mail) abaixo.

**Descri√ß√£o:** Envia notifica√ß√£o formatada com todos os detalhes do checking.

---

#### N√≥ 23: Responder Sucesso
**Tipo:** `n8n-nodes-base.respondToWebhook`
**Configura√ß√£o:**
```yaml
respondWith: json
responseBody: |
  {
    "success": true,
    "message": "Checking enviado com sucesso!"
  }
```

**Descri√ß√£o:** Retorna confirma√ß√£o de sucesso ao front-end.

---

## C√≥digos JavaScript

### Valida√ß√£o de Anexos por Meio

```javascript
// Mapeamento completo de anexos obrigat√≥rios por meio
const anexosRequeridosPorMeio = {
  'DO': [
    'relatorio_fotografico_do',
    'relatorio_exibicoes_do',
    'video_diurno_do'
  ],
  'ME': [
    'relatorio_enderecos_me',
    'fotos_pontos_me'
  ],
  'MO': [
    'relatorio_estacoes_mo',
    'fotos_videos_mo'
  ],
  'BD': ['comprovante_bd'],
  'OD': ['comprovante_od_fl'],
  'FL': ['comprovante_od_fl'],
  'MI': ['comprovante_mi'],
  'AT': ['comprovante_geral'],
  'CI': ['comprovante_geral'],
  'IN': ['comprovante_geral'],
  'JO': ['comprovante_geral'],
  'RD': ['comprovante_geral'],
  'RV': ['comprovante_geral'],
  'TV': ['comprovante_geral'],
  'TP': ['comprovante_geral']
};

// Valida√ß√£o
const meio = body.meio;
const camposRequeridos = anexosRequeridosPorMeio[meio];

if (!camposRequeridos) {
  throw new Error(`Meio '${meio}' n√£o configurado`);
}

const anexosFaltando = [];

camposRequeridos.forEach(campo => {
  const temArquivo = Object.keys(binary).some(key => {
    return key === campo || key.startsWith(campo + '_');
  });
  
  if (!temArquivo) {
    anexosFaltando.push(campo);
  }
});

if (anexosFaltando.length > 0) {
  throw new Error(`Anexos faltando: ${anexosFaltando.join(', ')}`);
}
```

### Extra√ß√£o de ID do Google Drive

```javascript
// Suporta m√∫ltiplos formatos de URL
function extrairDriveId(url) {
  // Formato: https://drive.google.com/drive/folders/FOLDER_ID
  const matchFolder = url.match(/folders\/([a-zA-Z0-9_-]+)/);
  if (matchFolder) return matchFolder[1];
  
  // Formato: https://drive.google.com/file/d/FILE_ID
  const matchFile = url.match(/\/d\/([a-zA-Z0-9_-]+)/);
  if (matchFile) return matchFile[1];
  
  // Formato: ID direto (25+ caracteres alfanum√©ricos)
  const matchDirect = url.match(/[-\w]{25,}/);
  if (matchDirect) return matchDirect[0];
  
  return null;
}

const driveId = extrairDriveId(body.drive_link);
if (!driveId) {
  throw new Error('N√£o foi poss√≠vel extrair ID do Drive');
}
```

### Formata√ß√£o de Nome de Pasta

```javascript
// Remove caracteres inv√°lidos para nomes de arquivo/pasta
function sanitizarNome(nome) {
  return nome.replace(/[\/\\?%*:|\"<>]/g, '-');
}

// Gera nome padronizado
const nomePasta = [
  'PI',
  n_pi,
  '-',
  sanitizarNome(cliente),
  '-',
  $now.toFormat("dd-MM-yyyy HH'h'mm")
].join(' ');

// Resultado: "PI 182429 - CLIENTE XYZ - 15-10-2025 14h30"
```

---

## Template HTML do E-mail

```html
<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
    <title>Notifica√ß√£o de Checking</title>
</head>
<body style="margin: 0; padding: 0; font-family: 'Inter', sans-serif; background-color: #f7fafc;">
    <table width="100%" border="0" cellspacing="0" cellpadding="0">
        <tr>
            <td align="center" style="padding: 20px;">
                <table width="650" border="0" cellspacing="0" cellpadding="0" style="background: #ffffff; border-radius: 8px;">
                    
                    <!-- Barra colorida superior -->
                    <tr>
                        <td height="4" style="background: linear-gradient(90deg, #ef4444 0%, #f59e0b 20%, #10b981 40%, #3b82f6 60%, #8b5cf6 80%, #ec4899 100%);"></td>
                    </tr>
                    
                    <!-- Cabe√ßalho -->
                    <tr>
                        <td align="center" style="padding: 40px; border-bottom: 1px solid #e2e8f0;">
                            <h1 style="font-size: 28px; font-weight: 800; color: #2d3748; margin: 0; text-transform: uppercase; letter-spacing: 2px;">
                                Novo Checking Recebido
                            </h1>
                            <p style="font-size: 16px; color: #4a5568; margin: 15px 0 0 0;">
                                Um novo comprovante foi submetido com sucesso.
                            </p>
                        </td>
                    </tr>
                    
                    <!-- Conte√∫do -->
                    <tr>
                        <td style="padding: 40px;">
                            <table width="100%" border="0" cellspacing="0" cellpadding="0">
                                <!-- Cliente e PI -->
                                <tr>
                                    <td width="50%" style="padding-right: 15px; padding-bottom: 30px;">
                                        <p style="font-size: 12px; color: #4a5568; margin: 0 0 8px 0; font-weight: 600; text-transform: uppercase;">
                                            Cliente
                                        </p>
                                        <p style="font-size: 18px; color: #2d3748; margin: 0; font-weight: 500;">
                                            {{ $json.cliente }}
                                        </p>
                                    </td>
                                    <td width="50%" style="padding-left: 15px; padding-bottom: 30px;">
                                        <p style="font-size: 12px; color: #4a5568; margin: 0 0 8px 0; font-weight: 600; text-transform: uppercase;">
                                            N¬∫ da PI
                                        </p>
                                        <p style="font-size: 18px; color: #2d3748; margin: 0; font-weight: 500;">
                                            {{ $json.n_pi }}
                                        </p>
                                    </td>
                                </tr>
                                
                                <!-- Ve√≠culo e Data -->
                                <tr>
                                    <td width="50%" style="padding-right: 15px; padding-bottom: 30px;">
                                        <p style="font-size: 12px; color: #4a5568; margin: 0 0 8px 0; font-weight: 600; text-transform: uppercase;">
                                            Ve√≠culo
                                        </p>
                                        <p style="font-size: 18px; color: #2d3748; margin: 0; font-weight: 500;">
                                            {{ $json.veiculo }}
                                        </p>
                                    </td>
                                    <td width="50%" style="padding-left: 15px; padding-bottom: 30px;">
                                        <p style="font-size: 12px; color: #4a5568; margin: 0 0 8px 0; font-weight: 600; text-transform: uppercase;">
                                            Data/Hora do Envio
                                        </p>
                                        <p style="font-size: 18px; color: #2d3748; margin: 0; font-weight: 500;">
                                            {{ $now.toFormat('dd/MM/yyyy HH:mm:ss') }}
                                        </p>
                                    </td>
                                </tr>
                                
                                <!-- Enviado por -->
                                <tr>
                                    <td colspan="2" style="padding-bottom: 30px;">
                                        <p style="font-size: 12px; color: #4a5568; margin: 0 0 8px 0; font-weight: 600; text-transform: uppercase;">
                                            Enviado por
                                        </p>
                                        <p style="font-size: 18px; color: #2d3748; margin: 0; font-weight: 500;">
                                            {{ $json.nome }}
                                        </p>
                                        <p style="font-size: 16px; color: #4a5568; margin: 5px 0 0 0;">
                                            {{ $json.email }}
                                        </p>
                                    </td>
                                </tr>
                                
                                <!-- Observa√ß√µes -->
                                <tr>
                                    <td colspan="2">
                                        <p style="font-size: 12px; color: #4a5568; margin: 0 0 8px 0; font-weight: 600; text-transform: uppercase;">
                                            Observa√ß√µes
                                        </p>
                                        <p style="font-size: 16px; color: #2d3748; margin: 0; background: #f7fafc; padding: 20px; border-radius: 4px; border: 1px solid #e2e8f0;">
                                            {{ $json.observacoes || 'Nenhuma observa√ß√£o foi fornecida.' }}
                                        </p>
                                    </td>
                                </tr>
                            </table>
                        </td>
                    </tr>
                    
                    <!-- Bot√£o -->
                    <tr>
                        <td align="center" style="padding: 0 40px 40px 40px;">
                            <a href="{{ $json.webViewLink }}" 
                               target="_blank" 
                               style="background: #0033a0; color: #ffffff; padding: 16px 40px; text-decoration: none; border-radius: 4px; font-size: 15px; font-weight: 700; display: inline-block; text-transform: uppercase; letter-spacing: 0.5px;">
                                Acessar Arquivos no Drive
                            </a>
                        </td>
                    </tr>

                    <!-- Barra colorida inferior -->
                    <tr>
                        <td height="4" style="background: linear-gradient(90deg, #ef4444 0%, #f59e0b 20%, #10b981 40%, #3b82f6 60%, #8b5cf6 80%, #ec4899 100%);"></td>
                    </tr>

                    <!-- Rodap√© -->
                    <tr>
                        <td align="center" style="padding: 40px; background: #e5e7eb;">
                            <p style="font-size: 32px; font-weight: 800; color: #2d3748; margin: 0; letter-spacing: 3px;">
                                GRUPO OM
                            </p>
                            <p style="font-size: 11px; color: #4a5568; margin: 8px 0 0 0; letter-spacing: 4px; text-transform: uppercase; font-weight: 600;">
                                Comunica√ß√£o Integrada
                            </p>
                        </td>
                    </tr>
                </table>
            </td>
        </tr>
    </table>
</body>
</html>
```

---

## Tratamento de Erros

### Estrat√©gias Implementadas

#### 1. Valida√ß√£o em M√∫ltiplas Camadas

```javascript
// Camada 1: Front-end (JavaScript)
if (!form.checkValidity()) {
  showError('Preencha todos os campos obrigat√≥rios');
  return;
}

// Camada 2: Webhook (n8n Code)
if (camposFaltando.length > 0) {
  return { 
    success: false, 
    message: `Campos faltando: ${camposFaltando.join(', ')}` 
  };
}

// Camada 3: APIs externas (try/catch)
try {
  await googleSheets.append(data);
} catch (error) {
  throw new Error(`Falha no Sheets: ${error.message}`);
}
```

#### 2. Mensagens de Erro Padronizadas

| C√≥digo | Mensagem | Causa Prov√°vel |
|--------|----------|----------------|
| 400 | Campos obrigat√≥rios faltando | Valida√ß√£o falhou |
| 400 | PI n√£o encontrada | PI n√£o existe no Sheets |
| 400 | Anexos obrigat√≥rios faltando | Arquivos n√£o enviados |
| 500 | Erro ao criar pasta no Drive | Falha na API do Drive |
| 500 | Erro ao enviar e-mail | Falha no SMTP |
| 504 | Timeout na execu√ß√£o | Arquivo muito grande |

#### 3. Rollback Autom√°tico

O n8n n√£o possui rollback nativo, mas o fluxo √© projetado para falhar cedo:

```
‚úÖ Valida√ß√µes ‚Üí ‚úÖ Buscar/Criar Pastas ‚Üí ‚úÖ Uploads ‚Üí ‚úÖ Log ‚Üí ‚úÖ E-mail
    ‚Üì Falha aqui             ‚Üì Falha aqui          ‚Üì          ‚Üì
  Retorna erro          Retorna erro        Apenas log   Falha silenciosa
```

**Estrat√©gia:** Validar tudo antes de modificar o Drive. Se falhar ap√≥s uploads, o log e e-mail s√£o opcionais.

---

## Otimiza√ß√µes e Performance

### 1. Upload Paralelo

```javascript
// Antes (Sequencial - LENTO)
for (const arquivo of arquivos) {
  await uploadArquivo(arquivo); // 10 arquivos = 10x tempo
}

// Depois (Paralelo - R√ÅPIDO)
const uploads = arquivos.map(arquivo => uploadArquivo(arquivo));
await Promise.all(uploads); // 10 arquivos = 1x tempo (do maior)
```

**Implementa√ß√£o no n8n:**
- O n√≥ "Separar Cada Arquivo" cria N itens
- "Upload Arquivo no Drive" executa em paralelo
- "Aguardar Todos Uploads" sincroniza

### 2. Caching de Pastas

```javascript
// Cache em mem√≥ria durante execu√ß√£o
let clientFolderId = null;

// Busca apenas se n√£o estiver em cache
if (!clientFolderId) {
  clientFolderId = await buscarPastaCliente();
}

// Reutiliza para m√∫ltiplas PIs do mesmo cliente
```

**Limita√ß√£o:** Cache n√£o persiste entre execu√ß√µes do workflow.

### 3. Queries Otimizadas

```javascript
// ‚ùå Ineficiente: Busca todas as linhas e filtra
const todasLinhas = await sheets.readAll();
const pi = todasLinhas.find(row => row.N_PI === npi);

// ‚úÖ Eficiente: Filtra no servidor
const pi = await sheets.read({
  filters: [{ column: 'N_PI', value: npi }]
});
```

### 4. Timeouts Generosos

```yaml
# Para arquivos grandes (v√≠deos, etc.)
N8N_WEBHOOK_TIMEOUT: 3600000      # 60 minutos
N8N_EXECUTIONS_TIMEOUT: 7200      # 2 horas
N8N_EXECUTIONS_TIMEOUT_MAX: 10800 # 3 horas
```

### 5. Limites de Mem√≥ria

```yaml
# Heap do Node.js para processar arquivos grandes
NODE_OPTIONS: --max-old-space-size=4096  # 4GB

# Limites de payload
N8N_PAYLOAD_SIZE_MAX: 800               # 800MB
N8N_FORMDATA_FILE_SIZE_MAX: 800         # 800MB

# Conex√µes simult√¢neas
serversTransport.maxIdleConnsPerHost: 500
```

---

## Manuten√ß√£o e Monitoramento

### Logs e Depura√ß√£o

#### 1. Logs do n8n

```bash
# Via Docker
docker logs n8n_container -f --tail 100

# Filtrar erros
docker logs n8n_container 2>&1 | grep -i "error"

# Filtrar por webhook espec√≠fico
docker logs n8n_container 2>&1 | grep "CheckingForm"
```

#### 2. Execu√ß√µes no n8n

**Acesso:**
1. Abra o n8n: `https://n8n.grupoom.com.br`
2. V√° em "Executions" (√≠cone de rel√≥gio)
3. Filtre por status:
   - ‚úÖ Success
   - ‚ùå Error
   - ‚è∏Ô∏è Running
   - ‚èπÔ∏è Waiting

**An√°lise de Execu√ß√£o:**
```javascript
// Em cada n√≥, verifique:
1. Input Data  ‚Üí O que o n√≥ recebeu
2. Output Data ‚Üí O que o n√≥ produziu
3. Execution Time ‚Üí Quanto tempo levou
4. Error Message ‚Üí Se houver falha
```

#### 3. Monitoramento de Erros Comuns

| Erro | Local | Solu√ß√£o |
|------|-------|---------|
| `CORS error` | Webhook | Verificar `N8N_CORS_ALLOWED_ORIGINS` |
| `PI n√£o encontrada` | Buscar PI | Verificar planilha e credenciais |
| `Insufficient permissions` | Google APIs | Renovar OAuth tokens |
| `File too large` | Upload | Verificar limites configurados |
| `Timeout` | Qualquer n√≥ | Aumentar timeouts |
| `Out of memory` | Upload grande | Aumentar `max-old-space-size` |

### Backup e Recupera√ß√£o

#### 1. Backup do Workflow

```bash
# Exportar workflow manualmente
# n8n ‚Üí Workflows ‚Üí CheckingForm ‚Üí ‚ãÆ ‚Üí Download

# Ou via API
curl -X GET https://n8n.grupoom.com.br/api/v1/workflows/[ID] \
  -H "X-N8N-API-KEY: sua-api-key" > workflow-backup.json
```

#### 2. Backup da Planilha

```javascript
// Script Google Apps Script
function backupPlanilha() {
  const ss = SpreadsheetApp.openById('1iwUay2RE8k1PumivMbEjuzIyw4CBaktJ2YPsR1iwe_Q');
  const backup = ss.copy('Backup Checkings - ' + new Date().toISOString());
  
  // Mover para pasta espec√≠fica
  const file = DriveApp.getFileById(backup.getId());
  const folder = DriveApp.getFolderById('ID_PASTA_BACKUPS');
  folder.addFile(file);
  DriveApp.getRootFolder().removeFile(file);
}

// Executar diariamente via trigger
```

#### 3. Backup de Dados do n8n

```bash
# Backup do banco de dados SQLite
docker exec n8n_container cp /home/node/.n8n/database.sqlite3 /files/backup.sqlite3

# Backup dos dados bin√°rios
docker exec n8n_container tar czf /files/binary-backup.tar.gz /home/node/.n8n/binary-data

# Copiar para host
docker cp n8n_container:/files/backup.sqlite3 ./backups/
docker cp n8n_container:/files/binary-backup.tar.gz ./backups/
```

### Manuten√ß√£o Preventiva

#### Checklist Semanal

- [ ] Verificar espa√ßo em disco do servidor
- [ ] Verificar logs por erros recorrentes
- [ ] Testar submiss√£o de formul√°rio
- [ ] Verificar se e-mails est√£o sendo enviados
- [ ] Verificar se pastas est√£o sendo criadas corretamente

#### Checklist Mensal

- [ ] Revisar execu√ß√µes com falha
- [ ] Verificar tempo m√©dio de execu√ß√£o
- [ ] Limpar execu√ß√µes antigas (manter √∫ltimos 30 dias)
- [ ] Verificar certificados SSL (renova√ß√£o Traefik)
- [ ] Fazer backup completo da planilha
- [ ] Testar restaura√ß√£o de backup

#### Checklist Trimestral

- [ ] Atualizar n8n para vers√£o mais recente
- [ ] Revisar e otimizar queries do Sheets
- [ ] Auditar permiss√µes das APIs Google
- [ ] Revisar estrutura de pastas no Drive
- [ ] Documentar mudan√ßas no workflow

### Performance Metrics

#### M√©tricas Recomendadas

```javascript
// Tempo m√©dio de execu√ß√£o por rota
{
  "busca_pi": "< 2s",
  "submissao_com_3_arquivos": "< 30s",
  "submissao_com_10_arquivos": "< 90s",
  "submissao_link_drive": "< 10s"
}

// Taxa de sucesso
{
  "target": "> 95%",
  "current": "98.5%"  // Exemplo
}

// Erros por categoria
{
  "validacao": "45%",      // Usu√°rio preencheu errado
  "api_google": "30%",     // Falha tempor√°ria
  "timeout": "15%",        // Arquivo muito grande
  "outros": "10%"
}
```

#### Monitoramento com n8n

```javascript
// Criar workflow separado para monitoramento
// Executa a cada hora via Cron

// 1. Buscar execu√ß√µes da √∫ltima hora
GET /api/v1/executions?filter={"workflowId":"ID","finished":true}

// 2. Calcular m√©tricas
const total = executions.length;
const sucesso = executions.filter(e => e.status === 'success').length;
const taxa = (sucesso / total * 100).toFixed(2);

// 3. Alertar se taxa < 90%
if (taxa < 90) {
  await enviarAlertaSlack({
    texto: `‚ö†Ô∏è Taxa de sucesso baixa: ${taxa}%`,
    detalhes: executions.filter(e => e.status === 'error')
  });
}
```

---

## Troubleshooting Avan√ßado

### Problema: Upload Trava em 99%

**Sintoma:** Barra de progresso chega a 99% mas n√£o finaliza.

**Causa:** O servidor est√° processando o arquivo ap√≥s receber.

**Solu√ß√£o:**
```javascript
// No front-end, adicionar timeout de seguran√ßa
xhr.timeout = 1800000; // 30 minutos

xhr.addEventListener('timeout', function() {
  showMessage('Upload demorou muito. Verifique se chegou no Drive.');
});
```

### Problema: "Insufficient Permissions" no Drive

**Sintoma:** Erro ao criar pasta ou fazer upload.

**Causa:** Token OAuth expirado ou permiss√µes insuficientes.

**Solu√ß√£o:**
```bash
# 1. No n8n, v√° em: Credentials ‚Üí Google Drive OAuth2
# 2. Clique em "Reconnect"
# 3. Autorize novamente com conta que tem permiss√µes

# 4. Verificar permiss√µes necess√°rias:
- https://www.googleapis.com/auth/drive
- https://www.googleapis.com/auth/drive.file
```

### Problema: Duplica√ß√£o de Pastas

**Sintoma:** M√∫ltiplas pastas criadas para mesma PI.

**Causa:** Execu√ß√µes paralelas ou retry autom√°tico.

**Solu√ß√£o:**
```javascript
// Adicionar verifica√ß√£o antes de criar pasta
const query = `name='PI ${npi}' and '${clientFolderId}' in parents and trashed=false`;
const existentes = await drive.search(query);

if (existentes.length > 0) {
  return existentes[0]; // Usar existente
}

// Criar apenas se n√£o existir
return await drive.createFolder(...);
```

### Problema: E-mails na Caixa de Spam

**Sintoma:** Notifica√ß√µes v√£o para spam.

**Solu√ß√µes:**
1. **Configurar SPF/DKIM:**
```dns
# No DNS do dom√≠nio
TXT @ "v=spf1 include:_spf.google.com ~all"
```

2. **Usar Gmail Workspace:**
```yaml
N8N_SMTP_HOST: smtp.gmail.com
N8N_SMTP_USER: noreply@grupoom.com.br  # Conta workspace
```

3. **Evitar palavras-gatilho:**
```html
<!-- ‚ùå Evitar -->
<h1>URGENTE! ATEN√á√ÉO!</h1>

<!-- ‚úÖ Preferir -->
<h1>Novo Checking Recebido</h1>
```

### Problema: Timeout em Arquivos Grandes

**Sintoma:** Upload falha ap√≥s 10-15 minutos.

**Diagn√≥stico:**
```bash
# Verificar timeouts em cada camada
1. Front-end xhr.timeout
2. Nginx/Traefik (proxy_read_timeout)
3. n8n (N8N_WEBHOOK_TIMEOUT)
4. Node.js (default 2 min)
```

**Solu√ß√£o Completa:**
```yaml
# Traefik (traefik.yml)
entrypoints:
  websecure:
    transport:
      respondingtimeouts:
        readtimeout: 3600s
        writetimeout: 3600s

# n8n (docker-compose.yml)
environment:
  - N8N_WEBHOOK_TIMEOUT=3600000

# Front-end (index.html)
xhr.timeout = 3600000; // 60 min
```

---

## Extens√µes e Melhorias Futuras

### 1. Valida√ß√£o de Tamanho Individual

```javascript
// Validar cada arquivo individualmente
for (const key in binary) {
  const arquivo = binary[key];
  const tamanhoMB = arquivo.fileSize / 1024 / 1024;
  
  if (tamanhoMB > 200) { // Limite por arquivo
    erros.push(`Arquivo ${arquivo.fileName} muito grande: ${tamanhoMB.toFixed(2)}MB`);
  }
}
```

### 2. Compress√£o Autom√°tica de Imagens

```javascript
// Adicionar n√≥ antes do upload
const sharp = require('sharp');

const imagemComprimida = await sharp(inputBuffer)
  .resize(1920, null, { // Max width 1920px
    withoutEnlargement: true
  })
  .jpeg({ quality: 85 })
  .toBuffer();
```

### 3. Notifica√ß√µes por Slack/Teams

```javascript
// Adicionar n√≥ alternativo ao e-mail
await fetch('https://hooks.slack.com/services/...', {
  method: 'POST',
  body: JSON.stringify({
    text: `Novo Checking - PI ${npi}`,
    blocks: [
      {
        type: 'section',
        fields: [
          { type: 'mrkdwn', text: `*Cliente:*\n${cliente}` },
          { type: 'mrkdwn', text: `*PI:*\n${npi}` }
        ]
      },
      {
        type: 'actions',
        elements: [{
          type: 'button',
          text: { type: 'plain_text', text: 'Ver no Drive' },
          url: webViewLink
        }]
      }
    ]
  })
});
```

### 4. Dashboard de M√©tricas

```javascript
// Workflow separado que roda diariamente
const hoje = new Date().toISOString().split('T')[0];
const logs = await sheets.read('Log_Checkings');

const metricas = {
  total_hoje: logs.filter(l => l.Data.startsWith(hoje)).length,
  por_cliente: {},
  por_veiculo: {},
  taxa_sucesso: 0
};

logs.forEach(log => {
  metricas.por_cliente[log.Cliente] = (metricas.por_cliente[log.Cliente] || 0) + 1;
  metricas.por_veiculo[log.Ve√≠culo] = (metricas.por_veiculo[log.Ve√≠culo] || 0) + 1;
});

// Enviar para dashboard ou Data Studio
```

### 5. Webhook de Confirma√ß√£o

```javascript
// Ap√≥s sucesso, chamar webhook do cliente
await fetch('https://sistema-cliente.com/webhook/checking', {
  method: 'POST',
  headers: { 'Content-Type': 'application/json' },
  body: JSON.stringify({
    pi: npi,
    status: 'recebido',
    drive_link: webViewLink,
    timestamp: new Date().toISOString()
  })
});
```

### 6. Assinatura Digital de Arquivos

```javascript
const crypto = require('crypto');

// Gerar hash SHA256 de cada arquivo
for (const arquivo of arquivos) {
  const hash = crypto
    .createHash('sha256')
    .update(arquivo.data)
    .digest('hex');
  
  arquivo.sha256 = hash;
}

// Salvar hashes no log para verifica√ß√£o futura
```

---

## Guia de Importa√ß√£o

### Importar Workflow no n8n

1. **Copiar JSON:**
   - Copie o conte√∫do do arquivo `workflow.json` deste reposit√≥rio

2. **Importar:**
   ```
   n8n ‚Üí Workflows ‚Üí Import from File/URL
   ‚Üí Cole o JSON ‚Üí Import
   ```

3. **Configurar Credenciais:**
   ```
   - Google Sheets OAuth2
   - Google Drive OAuth2
   - SMTP (Gmail)
   ```

4. **Ajustar IDs:**
   - ID da Planilha: `1iwUay2RE8k1PumivMbEjuzIyw4CBaktJ2YPsR1iwe_Q`
   - ID da Pasta Raiz Drive: `1OEL4MtYKd5Tg-ZOmsIRG9RQkvfX-xs_s`
   - ID da Aba Log: `1807228652`

5. **Ativar Workflow:**
   ```
   Toggle no canto superior direito ‚Üí Active
   ```

### Testar Workflow

```bash
# Teste 1: Busca de PI
curl -X POST https://n8n.grupoom.com.br/webhook/CheckingForm \
  -H "Content-Type: application/json" \
  -d '{"action":"buscar_pi","n_pi":"182429"}'

# Teste 2: Submiss√£o (com httpie para multipart)
http --form POST https://n8n.grupoom.com.br/webhook/CheckingForm \
  action="submissao_form" \
  nome="Teste" \
  email="teste@test.com" \
  telefone="11999999999" \
  n_pi="182429" \
  meio="DO" \
  comprovante@test.pdf
```

---

## Refer√™ncias

### Documenta√ß√£o Oficial

- [n8n Documentation](https://docs.n8n.io/)
- [Google Sheets API](https://developers.google.com/sheets/api)
- [Google Drive API](https://developers.google.com/drive/api/v3)
- [Traefik Documentation](https://doc.traefik.io/traefik/)
- [Plesk Documentation](https://docs.plesk.com/)

### Recursos √öteis

- [n8n Community Forum](https://community.n8n.io/)
- [n8n Templates](https://n8n.io/workflows/)
- [Google OAuth Scopes](https://developers.google.com/identity/protocols/oauth2/scopes)
- [Plesk Extensions](https://www.plesk.com/extensions/)

### Suporte

- **GitHub Issues:** [github.com/phillipebarros-dot/Formulario-Cheking/issues](https://github.com/phillipebarros-dot/Formulario-Cheking/issues)
- **E-mail:** phillipe.barros@grupoom.com.br
- **Equipe TAS:** Tecnologia e Arquitetura de Solu√ß√µes - Grupo OM
- **Documenta√ß√£o:** Este arquivo e README.md

---

## Deploy e Integra√ß√£o

### Hospedagem do Formul√°rio (Plesk CentralServer)

O formul√°rio est√° hospedado em servidor Plesk CentralServer, gerenciado pela equipe TAS.

**Informa√ß√µes do Servidor:**
- **URL Painel:** https://177.101.144.106 (acesso interno/VPN)
- **URL Alternativa (SSL):** https://www201.centralserver.com.br:443
- **Dom√≠nio P√∫blico:** formschecking.grupoom.com.br
- **Gerenciado por:** Equipe TAS (Tecnologia e Arquitetura de Solu√ß√µes)

> ‚ö†Ô∏è **Nota:** O acesso ao painel Plesk √© restrito √† equipe TAS. Desenvolvedores devem seguir o processo de Pull Request no GitHub.

#### Atualizar Formul√°rio no Plesk

**Op√ß√£o 1: Git (Recomendado)**
```bash
# No Plesk, configurar Git Deploy
Plesk ‚Üí Git ‚Üí Manage
‚Üí Pull updates manually ou automaticamente
```

**Op√ß√£o 2: File Manager**
```
Plesk ‚Üí File Manager ‚Üí httpdocs/
‚Üí Upload do novo index.html
```

**Op√ß√£o 3: FTP/SFTP**
```bash
sftp usuario@formschecking.grupoom.com.br
cd httpdocs
put index.html
```

#### Verificar Deployment

```bash
# Verificar vers√£o atual
curl https://formschecking.grupoom.com.br | grep -o 'version: [0-9.]*'

# Limpar cache do navegador
Ctrl + Shift + R (ou Cmd + Shift + R no Mac)

# Verificar logs
Plesk ‚Üí Logs ‚Üí Access Log e Error Log
```

---

## Changelog do Workflow

### v1.0.0 (2025-01-15)
- ‚ú® Implementa√ß√£o inicial completa
- ‚úÖ Roteamento por a√ß√£o (busca/submiss√£o)
- ‚úÖ Valida√ß√£o h√≠brida de dados
- ‚úÖ Upload paralelo de arquivos
- ‚úÖ Organiza√ß√£o autom√°tica no Drive
- ‚úÖ Sistema de notifica√ß√µes por e-mail
- ‚úÖ Logging completo no Sheets

### Melhorias Planejadas (v1.1.0)
- üîÑ Retry autom√°tico em falhas de API
- üìä Dashboard de m√©tricas
- üîî Notifica√ß√µes via Slack/Teams
- üóúÔ∏è Compress√£o autom√°tica de imagens
- üîê Assinatura digital de arquivos
- üì± Notifica√ß√£o push para mobile

---

**√öltima Atualiza√ß√£o:** 2025-01-15  
**Vers√£o do Documento:** 1.0.0  
**Autor:** Phillipe Barros - Grupo OM
